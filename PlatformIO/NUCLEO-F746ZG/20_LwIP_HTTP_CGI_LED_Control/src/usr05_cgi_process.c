/*
# ##############################################################################
# File: usr05_cgi_process.c                                                    #
# Project: src                                                                 #
# Created Date: Friday, October 13th 2023, 3:51:04 am                          #
# Author: Zafeer Abbasi                                                        #
# ----------------------------------------------                               #
# Last Modified: Friday, October 13th 2023, 6:45:18 am                         #
# Modified By: Zafeer Abbasi                                                   #
# ----------------------------------------------                               #
# Copyright (c) 2023 Zafeer.A                                                  #
# ----------------------------------------------                               #
# HISTORY:                                                                     #
 */

/*##############################################################################################################################################*/
/*INCLUDES______________________________________________________________________________________________________________________________________*/
/*##############################################################################################################################################*/

#include "usr05_cgi_process.h"
#include <string.h>
#include <stdio.h>
#include "lwip/apps/httpd.h"

/*##############################################################################################################################################*/
/*FUNCTION DECLARATIONS_________________________________________________________________________________________________________________________*/
/*##############################################################################################################################################*/

const char *CGI_ledCGIHandler( int iIndex, int iNumParams, char *pcParam[ ], char *pcValue[ ] );
const char *CGI_sliderHandler( int iIndex, int iNumParams, char *pcParam[ ], char *pcValue[ ] );

/*##############################################################################################################################################*/
/*GLOBALS_______________________________________________________________________________________________________________________________________*/
/*##############################################################################################################################################*/

const tCGI CGI_LED = { "/leds.cgi", CGI_ledCGIHandler };
const tCGI CGI_SLIDER = { "/slider.cgi", CGI_sliderHandler };
tCGI ARR_CGI[ NUM_OF_CGI ];

/*##############################################################################################################################################*/
/*DEFINES_______________________________________________________________________________________________________________________________________*/
/*##############################################################################################################################################*/



/*##############################################################################################################################################*/
/*TYPEDEFS/STRUCTS/ENUMS________________________________________________________________________________________________________________________*/
/*##############################################################################################################################################*/



/*##############################################################################################################################################*/
/*FUNCTIONS_____________________________________________________________________________________________________________________________________*/
/*##############################################################################################################################################*/

const char *CGI_ledCGIHandler( int iIndex, int iNumParams, char *pcParam[ ], char *pcValue[ ] )
{
    if( iIndex == 0 )
    {
        LED_deactivateLED( GREEN_LED );
        LED_deactivateLED( BLUE_LED );
        LED_deactivateLED( RED_LED );
    }

    for( int i = 0; i < iNumParams; i++ )
    {
        if( strcmp( pcParam[ i ], "led" ) == 0 )
        {
            if( strcmp( pcValue[ i ], "1" ) == 0 )
            {
                
                LED_activateLED( GREEN_LED );
                printf( "Green LED is ON \r\n" );
            
            }
            else if( strcmp( pcValue[ i ], "2" ) == 0 )
            {

                LED_activateLED( BLUE_LED );
                printf( "Blue LED is ON \r\n" );

            }
            else if( strcmp( pcValue[ i ], "3" ) == 0 )
            {
                
                LED_activateLED( RED_LED );
                printf( "Red LED is ON \r\n" );
            
            }
            else if( strcmp( pcValue[ i ], "4" ) == 0 )
            {

                printf( "Custom LED Selected \r\n" );  
                              
            }
        }
    }

    return "/led_control.html";
}


const char *CGI_sliderHandler( int iIndex, int iNumParams, char *pcParam[ ], char *pcValue[ ] )
{
    // Directly process the slider value since we know we only have one parameter
        int value = atoi(pcValue[0]);
        printf("Slider Value: %d\r\n", value );
    return "/led_control.html";
}



/*##############################################################################################################################################*/
/*EXTERNS_______________________________________________________________________________________________________________________________________*/
/*##############################################################################################################################################*/